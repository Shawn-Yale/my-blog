---
title: Tarjan算法(SCC/LCA)
date: 2025-04-21 19:31:55
tags: [图论]
categories: [算法笔记]
---

# 一、Tarjan 算法到底是什么？

Tarjan 算法其实是一类算法的统称，由 Robert Tarjan 提出，常用于图的深度优先搜索（DFS）中解决一些结构问题。它的核心思想是：通过 DFS 的过程维护一些“时间戳”或“祖先信息”，从而高效地求解图中的结构性质。

最常见的有两个版本：

1. Tarjan 算法求 **强连通分量**（SCC） → 用于有向图。
2. Tarjan 算法求 **最近公共祖先**（LCA） → 用于树上离线求多对节点之间的最近公共祖先。

---

# 二、Tarjan 算法求强连通分量（SCC）

📌 **适用场景：**
- 给定一个 有向图，求它的所有 强连通分量（SCC，Strongly Connected Component）
- 强连通分量：从 A 能到 B 且从 B 也能到 A，所有这样的点组成的子图叫 SCC。

📌 **基本思想：**
- 对图进行 DFS，并给每个点分配一个 dfs 序号（时间戳）
- 用一个栈维护“当前路径上的点”
- 用 `low[]` 数组表示：当前点 u 能通过若干条边回到的最早祖先的 dfs 序
- 当发现某个点 u 的 `low[u] == dfn[u]`，说明它是一个强连通分量的“根”
- 然后从栈中弹出所有属于这个 SCC 的点

📌 **时间复杂度：** O(n + m)，非常快！

📌 **图示示例：**

输入图：
```text
1 → 2 → 3 → 1  
4 → 5  
5 → 6 → 4
```

强连通分量为：

- {1, 2, 3}
- {4, 5, 6}

---

# 三、Tarjan 算法求 LCA（树上最近公共祖先）

📌 **适用场景：**
- 给定一棵树 + 多个询问：询问任意两点的最近公共祖先
- 因为询问很多（如 2 万次），在线算法效率不够高 → 用 Tarjan 离线算法

📌 **核心思想：**
- 先遍历整棵树，用 DFS 的过程中处理询问
- 维护并查集，在回溯的时候把子节点合并到当前节点上
- 当一个询问 (u,v) 中，v 已经遍历完（已经“回溯”）了，那么 u 和 v 的 LCA 就是 find(v) 找到的根节点

📌 **优势：**
- 时间复杂度 O(n + mα(n))，α(n) 是反 Ackermann 函数，几乎是常数，非常快！

---

# 四、总结表格：

| 问题类型             | 图类型    | Tarjan用途              | 是否在线 | 用到了什么结构     |
|----------------------|-----------|--------------------------|----------|----------------------|
| 强连通分量 (SCC)     | 有向图    | 拆解图中所有 SCC         | 是       | 栈 + dfn + low       |
| 最近公共祖先 (LCA)   | 树        | 高效地离线处理多个查询   | 否（离线）| 并查集 + DFS         |

---
